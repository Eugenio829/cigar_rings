{% extends "base.html" %}
{% load static %}

{% block title %}Consulta de Grabados - Cigar Rings{% endblock %}

{% block content %}

<!-- Main Content -->
<main class="main-content">
    <!-- Page Header -->
    <div class="page-header">
        <h1 class="page-title">
            📋 Gestión de Órdenes de Fabricación
        </h1>
        <p class="page-subtitle">Administra y controla todas las OF del sistema de grabados</p>
        <div class="breadcrumb">
            <span>🏠 Inicio</span> › <span>📋 Gestión de Grabados</span> › <strong>Tabla de Registros</strong>
        </div>
    </div>

    <!-- Table Container -->
    <div class="table-container">
        <div class="table-header">
            <div class="table-title">
                📊 Registro de Órdenes de Fabricación
            </div>
            <div class="table-actions" style="display: block !important;">
                <div class="search-box">
                    <input type="text" class="search-input" id="search-input" placeholder="Buscar OF, cliente, descripción...">
                    <span class="search-icon">🔍</span>
                </div>
                <button class="btn btn-secondary" onclick="showFilters()">
                    🔽 Filtros
                </button>
                <button class="btn btn-primary" onclick="addNewOF()">
                    ➕ Nueva OF
                </button>
                <button type="button" class="btn btn-success" id="exportBtn">
                    📤 Exportar
                </button>
                <button>TEST BUTTON</button>

            </div>
        </div>

        <div class="table-wrapper">
            <table id="ofTable">
                <thead>
                    <tr>
                        <th>OF.</th>
                        <th>OF. Referencia</th>
                        <th>Descripción</th>
                        <th>Cliente</th>
                        <th>Tipo de grabado</th>
                        <th>Proceso</th>
                        <th>Máquina</th>
                        <th>Estado</th>
                        <th>Fecha de Prog.</th>
                        <th>Ubicación</th>
                        <th>Ubicación Carpeta</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="grabado-table-body">
                    {% for grabado in grabados %}
                    <tr>
                        <td data-label="OF.">{{ grabado.of_numero }}</td>
                        <td data-label="OF. Referencia"><span class="of-reference">{{ grabado.of_referencia }}</span></td>
                        <td data-label="Descripción">{{ grabado.descripcion }}</td>
                        <td data-label="Cliente"><span class="client-name">{{ grabado.cliente }}</span></td>
                        <td data-label="Tipo de grabado">{{ grabado.tipo_grabado.nombre|default:"N/A" }}</td>
                        <td data-label="Proceso">{{ grabado.proceso.nombre|default:"N/A" }}</td>
                        <td data-label="Máquina"><span class="machine-tag">{{ grabado.maquina.nombre|default:"N/A" }}</span></td>
                        <td data-label="Estado"><span class="status-badge status-{{ grabado.estado|lower }}">{{ grabado.get_estado_display }}</span></td>
                        <td data-label="Fecha de Prog.">{{ grabado.fecha_programacion|date:"Y-m-d" }}</td>
                        <td data-label="Ubicación"><span class="location-info">{{ grabado.ubicacion|default:"-" }}</span></td>
                        <td data-label="Ubicación Carpeta"><span class="location-info">{{ grabado.ubicacion_carpeta|default:"-" }}</span></td>
                        <td data-label="Acciones">
                            <div class="action-buttons">
                                {# Ajusta los URLs cuando tengas las vistas de editar/eliminar #}
                                <button class="btn-action btn-view" title="Ver detalles">👁️</button>
                                <button class="btn-action btn-edit" title="Editar">✏️</button>
                                <button class="btn-action btn-delete" title="Eliminar">🗑️</button>
                            </div>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="12" style="text-align: center; padding: 20px;">No se encontraron registros que coincidan con su búsqueda.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <div class="pagination">
            <div class="pagination-info">
                Mostrando 1-5 de 25 registros
            </div>
            <div class="pagination-controls">
                <button class="pagination-btn disabled">‹ Anterior</button>
                <button class="pagination-btn active">1</button>
                <button class="pagination-btn">2</button>
                <button class="pagination-btn">3</button>
                <button class="pagination-btn">Siguiente ›</button>
            </div>
        </div>
    </div>

    <!-- Export Modal -->
    <div id="exportModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Opciones de Exportación</h2>
                <span class="close-button">&times;</span>
            </div>
            <div class="modal-body">
                <p>Selecciona el tipo de archivo que deseas descargar:</p>
                <ul class="export-options">
                    <li>
                        <a href="{% url 'exportar_excel' %}?tipo=plantilla" class="btn btn-secondary">
                            📄 Descargar Plantilla Vacía
                        </a>
                        <p class="option-description">Un archivo Excel solo con los encabezados de las columnas. Ideal para empezar a llenar datos desde cero.</p>
                    </li>
                    <li>
                        <a href="{% url 'exportar_excel' %}?tipo=ejemplo" class="btn btn-secondary">
                            📝 Descargar Plantilla con Ejemplo
                        </a>
                        <p class="option-description">Un archivo Excel con los encabezados y una fila de datos de ejemplo para guiarte.</p>
                    </li>
                    <li>
                        <a href="{% url 'exportar_excel' %}?tipo=todo" class="btn btn-primary">
                            📊 Exportar Todos los Datos
                        </a>
                        <p class="option-description">Un archivo Excel con todos los registros de grabados que se encuentran actualmente en la base de datos.</p>
                    </li>
                </ul>
            </div>
        </div>
    </div>

</main>

 



{% endblock %}
